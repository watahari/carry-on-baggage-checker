<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ãƒ†ã‚¹ãƒˆå®Ÿè¡Œçµæœ - æ‰‹è·ç‰©æŒã¡è¾¼ã¿åˆ¤å®šãƒ„ãƒ¼ãƒ«</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .header {
        text-align: center;
        margin-bottom: 30px;
        padding: 20px;
        background: linear-gradient(135deg, #2563eb, #10b981);
        color: white;
        border-radius: 8px;
      }
      .test-section {
        margin-bottom: 30px;
        padding: 20px;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
      }
      .test-section h3 {
        color: #1e293b;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .test-item {
        padding: 10px;
        margin: 10px 0;
        border-radius: 4px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .test-pass {
        background-color: #dcfce7;
        border-left: 4px solid #10b981;
      }
      .test-fail {
        background-color: #fef2f2;
        border-left: 4px solid #ef4444;
      }
      .test-status {
        font-weight: bold;
      }
      .test-pass .test-status {
        color: #10b981;
      }
      .test-fail .test-status {
        color: #ef4444;
      }
      .run-tests-btn {
        background: #2563eb;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 6px;
        font-size: 16px;
        cursor: pointer;
        margin-bottom: 20px;
      }
      .run-tests-btn:hover {
        background: #1d4ed8;
      }
      .console-output {
        background: #1a1a1a;
        color: #00ff00;
        padding: 15px;
        border-radius: 6px;
        font-family: monospace;
        font-size: 14px;
        max-height: 300px;
        overflow-y: auto;
        white-space: pre-wrap;
      }
      .summary {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }
      .summary-card {
        padding: 20px;
        border-radius: 8px;
        text-align: center;
      }
      .summary-card.total {
        background: #f1f5f9;
        border: 2px solid #cbd5e1;
      }
      .summary-card.pass {
        background: #dcfce7;
        border: 2px solid #10b981;
      }
      .summary-card.fail {
        background: #fef2f2;
        border: 2px solid #ef4444;
      }
      .summary-card h4 {
        margin: 0 0 10px 0;
        color: #374151;
      }
      .summary-card .number {
        font-size: 2rem;
        font-weight: bold;
        margin: 0;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>ğŸ§ª ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆå®Ÿè¡Œ</h1>
        <p>æ‰‹è·ç‰©æŒã¡è¾¼ã¿åˆ¤å®šãƒ„ãƒ¼ãƒ«ã®è‡ªå‹•ãƒ†ã‚¹ãƒˆ</p>
      </div>

      <button class="run-tests-btn" onclick="runAllTests()">ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ</button>

      <div class="summary" id="testSummary">
        <div class="summary-card total">
          <h4>ç·ãƒ†ã‚¹ãƒˆæ•°</h4>
          <div class="number" id="totalTests">-</div>
        </div>
        <div class="summary-card pass">
          <h4>æˆåŠŸ</h4>
          <div class="number" id="passedTests">-</div>
        </div>
        <div class="summary-card fail">
          <h4>å¤±æ•—</h4>
          <div class="number" id="failedTests">-</div>
        </div>
      </div>

      <div class="test-section">
        <h3>ğŸ“Š ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿æ©Ÿèƒ½</h3>
        <div id="dataLoadingTests">ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„</div>
      </div>

      <div class="test-section">
        <h3>ğŸ§® åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯</h3>
        <div id="compatibilityTests">ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„</div>
      </div>

      <div class="test-section">
        <h3>ğŸŒ å¤šè¨€èªæ©Ÿèƒ½</h3>
        <div id="i18nTests">ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„</div>
      </div>

      <div class="test-section">
        <h3>ğŸ”— çµ±åˆãƒ†ã‚¹ãƒˆ</h3>
        <div id="integrationTests">ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„</div>
      </div>

      <div class="test-section">
        <h3>ğŸ“‹ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</h3>
        <div class="console-output" id="consoleOutput">ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå¾Œã«ã“ã“ã«å‡ºåŠ›ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</div>
      </div>
    </div>

    <script src="test/test-utils.js"></script>
    <script>
      let testResults = {
        total: 0,
        passed: 0,
        failed: 0,
        details: []
      };

      function log(message) {
        const consoleOutput = document.getElementById('consoleOutput');
        const timestamp = new Date().toLocaleTimeString();
        consoleOutput.textContent += `[${timestamp}] ${message}\n`;
        consoleOutput.scrollTop = consoleOutput.scrollHeight;
      }

      function updateSummary() {
        document.getElementById('totalTests').textContent = testResults.total;
        document.getElementById('passedTests').textContent = testResults.passed;
        document.getElementById('failedTests').textContent = testResults.failed;
      }

      function createTestItem(testName, passed, error = null) {
        const testItem = document.createElement('div');
        testItem.className = `test-item ${passed ? 'test-pass' : 'test-fail'}`;

        const testDescription = document.createElement('span');
        testDescription.textContent = testName;

        const testStatus = document.createElement('span');
        testStatus.className = 'test-status';
        testStatus.textContent = passed ? 'âœ… PASS' : 'âŒ FAIL';

        testItem.appendChild(testDescription);
        testItem.appendChild(testStatus);

        if (error) {
          const errorDiv = document.createElement('div');
          errorDiv.style.cssText =
            'margin-top: 10px; font-size: 12px; color: #666; font-family: monospace;';
          errorDiv.textContent = error;
          testItem.appendChild(errorDiv);
        }

        return testItem;
      }

      // TSVãƒ‘ãƒ¼ã‚¹æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ
      function testDataParsing() {
        log('ğŸ“Š ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆé–‹å§‹');
        const container = document.getElementById('dataLoadingTests');
        container.innerHTML = '';

        const tests = [
          {
            name: 'TSVãƒ‡ãƒ¼ã‚¿ã®æ­£å¸¸è§£æ',
            test: () => {
              const tsvData = `ICAO code\tIATA code\tèˆªç©ºä¼šç¤¾å
ANA\tNH\tå…¨æ—¥æœ¬ç©ºè¼¸
JAL\tJL\tæ—¥æœ¬èˆªç©º`;
              const result = parseTSV(tsvData);
              return result.length === 2 && result[0]['ICAO code'] === 'ANA';
            }
          },
          {
            name: 'ç©ºãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†',
            test: () => {
              const result = parseTSV('ICAO code\tIATA code\tèˆªç©ºä¼šç¤¾å');
              return result.length === 0;
            }
          },
          {
            name: 'ä¸æ­£è¡Œã®é™¤å¤–',
            test: () => {
              const tsvData = `ICAO code\tIATA code\tèˆªç©ºä¼šç¤¾å
ANA\tNH\tå…¨æ—¥æœ¬ç©ºè¼¸
INVALID_ROW
JAL\tJL\tæ—¥æœ¬èˆªç©º`;
              const result = parseTSV(tsvData);
              return result.length === 1 && result[0]['ICAO code'] === 'JAL';
            }
          }
        ];

        tests.forEach(testCase => {
          try {
            const passed = testCase.test();
            container.appendChild(createTestItem(testCase.name, passed));
            testResults.total++;
            if (passed) testResults.passed++;
            else testResults.failed++;
            log(`${testCase.name}: ${passed ? 'PASS' : 'FAIL'}`);
          } catch (error) {
            container.appendChild(createTestItem(testCase.name, false, error.message));
            testResults.total++;
            testResults.failed++;
            log(`${testCase.name}: FAIL - ${error.message}`);
          }
        });
      }

      // åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ã®ãƒ†ã‚¹ãƒˆ
      function testCompatibilityLogic() {
        log('ğŸ§® åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ãƒ†ã‚¹ãƒˆé–‹å§‹');
        const container = document.getElementById('compatibilityTests');
        container.innerHTML = '';

        const tests = [
          {
            name: 'åˆ¶é™å†…ã‚¹ãƒ¼ãƒ„ã‚±ãƒ¼ã‚¹ã®åˆ¤å®š',
            test: () => {
              const suitcase = createMockSuitcase(50, 35, 20, 5);
              const baggage = createMockBaggage('ANA', 55, 40, 25, 115, 10);
              return checkSuitcaseCompatibility(suitcase, baggage);
            }
          },
          {
            name: 'å¹…è¶…éã‚¹ãƒ¼ãƒ„ã‚±ãƒ¼ã‚¹ã®åˆ¤å®š',
            test: () => {
              const suitcase = createMockSuitcase(60, 35, 20, 5);
              const baggage = createMockBaggage('ANA', 55, 40, 25, 115, 10);
              return !checkSuitcaseCompatibility(suitcase, baggage);
            }
          },
          {
            name: 'é‡é‡è¶…éã‚¹ãƒ¼ãƒ„ã‚±ãƒ¼ã‚¹ã®åˆ¤å®š',
            test: () => {
              const suitcase = createMockSuitcase(50, 35, 20, 15);
              const baggage = createMockBaggage('ANA', 55, 40, 25, 115, 10);
              return !checkSuitcaseCompatibility(suitcase, baggage);
            }
          },
          {
            name: '3è¾ºåˆè¨ˆè¶…éã‚¹ãƒ¼ãƒ„ã‚±ãƒ¼ã‚¹ã®åˆ¤å®š',
            test: () => {
              const suitcase = createMockSuitcase(55, 40, 25, 5); // 120cm
              const baggage = createMockBaggage('ANA', 55, 40, 25, 115, 10);
              return !checkSuitcaseCompatibility(suitcase, baggage);
            }
          },
          {
            name: 'é‡é‡åˆ¶é™ãªã—ã®å‡¦ç†',
            test: () => {
              const suitcase = createMockSuitcase(50, 35, 20, 50);
              const baggage = createMockBaggage('TEST', 55, 40, 25, 115, null);
              return checkSuitcaseCompatibility(suitcase, baggage);
            }
          }
        ];

        tests.forEach(testCase => {
          try {
            const passed = testCase.test();
            container.appendChild(createTestItem(testCase.name, passed));
            testResults.total++;
            if (passed) testResults.passed++;
            else testResults.failed++;
            log(`${testCase.name}: ${passed ? 'PASS' : 'FAIL'}`);
          } catch (error) {
            container.appendChild(createTestItem(testCase.name, false, error.message));
            testResults.total++;
            testResults.failed++;
            log(`${testCase.name}: FAIL - ${error.message}`);
          }
        });
      }

      // å¤šè¨€èªæ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆï¼ˆç°¡æ˜“ç‰ˆï¼‰
      function testI18n() {
        log('ğŸŒ å¤šè¨€èªæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆé–‹å§‹');
        const container = document.getElementById('i18nTests');
        container.innerHTML = '';

        const tests = [
          {
            name: 'DOMè¦ç´ ã®å­˜åœ¨ç¢ºèª',
            test: () => {
              return document.querySelector('[data-lang="ja"]') !== null;
            }
          },
          {
            name: 'è¨€èªãƒœã‚¿ãƒ³ã®è¨­å®š',
            test: () => {
              const jaBtn = document.querySelector('[data-lang="ja"]');
              const enBtn = document.querySelector('[data-lang="en"]');
              return jaBtn && enBtn;
            }
          }
        ];

        // ç°¡æ˜“çš„ãªå¤šè¨€èªãƒ†ã‚¹ãƒˆè¦ç´ ã‚’å‹•çš„ã«è¿½åŠ 
        const testElements = document.createElement('div');
        testElements.innerHTML = `
                <button data-lang="ja" class="lang-btn active">æ—¥æœ¬èª</button>
                <button data-lang="en" class="lang-btn">English</button>
            `;
        testElements.style.display = 'none';
        document.body.appendChild(testElements);

        tests.forEach(testCase => {
          try {
            const passed = testCase.test();
            container.appendChild(createTestItem(testCase.name, passed));
            testResults.total++;
            if (passed) testResults.passed++;
            else testResults.failed++;
            log(`${testCase.name}: ${passed ? 'PASS' : 'FAIL'}`);
          } catch (error) {
            container.appendChild(createTestItem(testCase.name, false, error.message));
            testResults.total++;
            testResults.failed++;
            log(`${testCase.name}: FAIL - ${error.message}`);
          }
        });

        // ãƒ†ã‚¹ãƒˆè¦ç´ ã‚’å‰Šé™¤
        document.body.removeChild(testElements);
      }

      // çµ±åˆãƒ†ã‚¹ãƒˆ
      function testIntegration() {
        log('ğŸ”— çµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹');
        const container = document.getElementById('integrationTests');
        container.innerHTML = '';

        const tests = [
          {
            name: 'æ¨™æº–ã‚¹ãƒ¼ãƒ„ã‚±ãƒ¼ã‚¹ã®è¤‡æ•°èˆªç©ºä¼šç¤¾åˆ¤å®š',
            test: () => {
              const suitcase = createMockSuitcase(50, 35, 20, 6);
              const baggages = [
                createMockBaggage('ANA', 55, 40, 25, 115, 10),
                createMockBaggage('JAL', 55, 40, 25, 115, 10),
                createMockBaggage('APJ', 55, 40, 25, 115, 7)
              ];

              const compatibleCount = baggages.filter(baggage =>
                checkSuitcaseCompatibility(suitcase, baggage)
              ).length;

              return compatibleCount >= 2; // å°‘ãªãã¨ã‚‚2ç¤¾ã¯å¯¾å¿œ
            }
          },
          {
            name: 'å¤§å‹ã‚¹ãƒ¼ãƒ„ã‚±ãƒ¼ã‚¹ã®å…¨ç¤¾ä¸é©åˆ',
            test: () => {
              const largeSuitcase = createMockSuitcase(60, 45, 30, 12);
              const baggages = [
                createMockBaggage('ANA', 55, 40, 25, 115, 10),
                createMockBaggage('JAL', 55, 40, 25, 115, 10)
              ];

              const compatibleCount = baggages.filter(baggage =>
                checkSuitcaseCompatibility(largeSuitcase, baggage)
              ).length;

              return compatibleCount === 0;
            }
          },
          {
            name: 'é‡é‡åˆ¶é™ã«ã‚ˆã‚‹å·®ç•°',
            test: () => {
              const heavySuitcase = createMockSuitcase(50, 35, 20, 8);
              const strictBaggage = createMockBaggage('APJ', 55, 40, 25, 115, 7);
              const normalBaggage = createMockBaggage('ANA', 55, 40, 25, 115, 10);

              const strictOk = checkSuitcaseCompatibility(heavySuitcase, strictBaggage);
              const normalOk = checkSuitcaseCompatibility(heavySuitcase, normalBaggage);

              return !strictOk && normalOk;
            }
          }
        ];

        tests.forEach(testCase => {
          try {
            const passed = testCase.test();
            container.appendChild(createTestItem(testCase.name, passed));
            testResults.total++;
            if (passed) testResults.passed++;
            else testResults.failed++;
            log(`${testCase.name}: ${passed ? 'PASS' : 'FAIL'}`);
          } catch (error) {
            container.appendChild(createTestItem(testCase.name, false, error.message));
            testResults.total++;
            testResults.failed++;
            log(`${testCase.name}: FAIL - ${error.message}`);
          }
        });
      }

      function runAllTests() {
        testResults = { total: 0, passed: 0, failed: 0, details: [] };

        document.getElementById('consoleOutput').textContent = '';
        log('ğŸš€ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé–‹å§‹');

        testDataParsing();
        testCompatibilityLogic();
        testI18n();
        testIntegration();

        updateSummary();

        log(`\nğŸ“Š ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå®Œäº†`);
        log(`ç·è¨ˆ: ${testResults.total} ä»¶`);
        log(`æˆåŠŸ: ${testResults.passed} ä»¶`);
        log(`å¤±æ•—: ${testResults.failed} ä»¶`);
        log(`æˆåŠŸç‡: ${Math.round((testResults.passed / testResults.total) * 100)}%`);
      }

      // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«åˆæœŸåŒ–
      document.addEventListener('DOMContentLoaded', () => {
        updateSummary();
        log(
          'ãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼ãŒæº–å‚™å®Œäº†ã—ã¾ã—ãŸã€‚"ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ"ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹ã—ã¦ãã ã•ã„ã€‚'
        );
      });
    </script>
  </body>
</html>
